<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<th:block th:fragment="formErrorsFragment">
    <ul th:if="${#fields.hasAnyErrors()}"> <!--#은 th:object아래에서만 쓸 수 있다.-->
        <!--        <li data-error-field-name="${err.split('-', 3)[1]}" th:each="err : ${#fields.allErrors().stream().sorted()}" th:text="${err.split('-', 3)[2]}"-->
        <!--            style="color: red;"></li>-->
        <li th:each="err : ${#fields.allErrors().stream().sorted()}"
            th:with="errStrs = ${err.split('-', 3)},
                    errFieldName = ${errStrs[1]},
                    errMsg = ${errStrs[2]}"
            th:data-error-field-name="${errFieldName}" th:text="${errMsg}"
            style="color: red;"></li>
    </ul>

    <script>
        const forms = document.querySelectorAll('form');
        const lastForm = forms[forms.length - 1];

        const errorFieldName = lastForm.querySelector('ul > li')?.dataset?.errorFieldName || '';

        //지연로딩 -> x초 뒤에 할일에 등록 0으로 해도 지연로딩됨
        if (errorFieldName.length > 0) {
            setTimeout(
                ()=> { lastForm[errorFieldName].focus(); },
                0);
        }
    </script>
</th:block>
</html>